# 出席管理システム v3.2 運用引継ぎ資料

**作成日**: 2025年7月22日  
**対象**: システム運用担当者・管理者  
**バージョン**: 3.2  

---

## 📋 引継ぎ概要

この資料は、出席管理システムv3.2の運用を担当者間で引き継ぐためのガイドです。
日常運用から緊急時対応まで、運用に必要な全ての情報を網羅しています。

## 🎯 引継ぎチェックリスト

### 【必須】引継ぎ前の確認事項
- [ ] システムの正常動作確認
- [ ] Google API認証情報の確認
- [ ] プリンター接続・動作確認
- [ ] 最新データのバックアップ作成
- [ ] 引継ぎ資料の内容確認

### 【必須】引継ぎ時の実施事項
- [ ] 実際の操作デモンストレーション
- [ ] トラブル時の連絡先共有
- [ ] 緊急時対応手順の説明
- [ ] 質疑応答・不明点の解消
- [ ] 引継ぎ完了の確認書類作成

---

## 🔧 システム構成・技術情報

### システム概要
- **アプリケーション**: Kivy デスクトップアプリケーション
- **言語**: Python 3.13.3
- **主要機能**: 出席管理、QRコード印刷、Excel月次レポート生成
- **外部連携**: Google Sheets、Google Drive、Brother P-touch Editor

### ファイル構成
```
attendance-management-system.3.2/
├── src/attendance_app/           # メインアプリケーション
├── manual/                      # ユーザーマニュアル
├── settings.json               # システム設定ファイル
├── service_account.json        # Google API認証ファイル
├── requirements.txt            # Python依存関係
└── print_history.json         # 印刷履歴
```

### 重要な設定ファイル

#### settings.json
```json
{
  "spreadsheet_id": "Google SheetsのID",
  "drive_qr_folder_id": "Google DriveフォルダのID", 
  "qr_code_folder": "QRコード保存フォルダパス",
  "ptouch_editor_path": "P-touch Editorのパス"
}
```

#### service_account.json
- Google API認証用のサービスアカウントファイル
- **絶対に外部に漏らさないこと**
- 紛失時は即座にシステム管理者に連絡

---

## 📅 日常運用業務

### 毎日の業務フロー

#### 1. 出席管理業務（平日毎日）
**時間**: 塾生の来塾時間帯  
**頻度**: 随時  

**手順**:
1. アプリケーション起動
2. QRスキャンまたは手動入力で出席記録
3. Google Sheetsへの自動同期確認

**注意点**:
- インターネット接続必須
- QRコード読み取り不可時は手動入力を使用
- エラー発生時は印刷履歴で確認

#### 2. QRコード印刷業務（不定期）
**時間**: 新入生の入塾時など  
**頻度**: 月1-2回程度  

**手順**:
1. Alt+Pで印刷画面へ移動
2. 「リスト更新」で最新生徒情報取得
3. 対象生徒選択後「このQRコードを印刷」実行

**注意点**:
- Brother QL-800の電源・接続確認
- ラベル用紙の在庫確認
- P-touch Editorの動作確認

### 週次業務

#### データ整合性確認（毎週金曜日推奨）
**手順**:
1. Google Sheetsで出席データ確認
2. 異常値・欠損データのチェック
3. 必要に応じて手動修正

#### システム動作確認
**手順**:
1. 全機能の動作テスト
2. プリンター印刷テスト
3. バックアップ作成

---

## 📊 月次運用業務

### 月初業務（1-5日）

#### 前月レポート生成
**手順**:
1. Alt+Rでレポート画面へ移動
2. 対象月選択（前月）
3. 「全生徒」または個別選択
4. 「Excel生成」実行
5. 出力ファイル確認

**生成場所**: `src/attendance_app/output/reports/`  
**ファイル名**: `月次レポート_YYYY年MM月.xlsx`

### 月末業務（26日-月末）

#### 講師コメント記入業務
**重要**: 月末までに全生徒分完了必須

**フロー**:
1. **準備** (26-28日)
   - 生成済みExcelファイル確認
   - 各生徒の月次振り返り情報準備

2. **コメント記入** (29日-月末)
   - 各生徒シートのコメント欄記入
   - プルダウンリスト選択（プランニング・カウンセリング・個別対応）
   - 記入漏れチェック

3. **最終確認・保存** (月末)
   - 全生徒のコメント確認
   - 「月次レポート_YYYY年MM月_完成版.xlsx」で保存
   - バックアップ作成

**品質基準**:
- 1生徒あたり150-200文字程度
- 具体的な成長ポイントと次月目標を記載
- 誤字脱字なし
- プルダウンリスト適切選択

### 翌月初業務（1-3日）
- 保護者配布用ファイル準備
- 前月ファイルのアーカイブ
- 新月度の準備

---

## 🚨 緊急時対応・トラブルシューティング

### システム起動エラー

#### 現象: アプリケーションが起動しない
**対処法**:
1. Pythonの動作確認
2. 依存関係の確認 (`pip install -r requirements.txt`)
3. ログファイル確認
4. 最後の手段：システム再起動

#### 現象: Google API接続エラー
**対処法**:
1. インターネット接続確認
2. service_account.jsonファイル確認
3. Google Sheets・Driveの権限確認
4. 時間を空けて再試行

### プリンターエラー

#### 現象: QRコード印刷できない
**対処法**:
1. プリンター電源・USB接続確認
2. Brother P-touch Editorの起動確認
3. プリンタードライバー再インストール
4. 別PCでの動作確認

### データ関連エラー

#### 現象: 出席データが同期されない
**緊急対応**:
1. 紙ベースで出席記録
2. Google Sheetsに手動入力
3. システム復旧後にデータ統合

#### 現象: Excel生成エラー
**対処法**:
1. 出力フォルダの容量確認
2. テンプレートファイル破損チェック
3. データの整合性確認
4. 別月での動作確認

### 月次レポート関連緊急対応

#### 現象: 月末にExcel生成できない
**緊急フロー**:
1. **即座の対応**（月末当日）
   - Google Sheetsから手動データエクスポート
   - Excelテンプレートに手動データ入力
   - 講師コメント記入続行

2. **翌日対応**
   - システム修復作業
   - 自動生成機能での再作成
   - データ整合性確認

#### 現象: コメント記入中にExcelが破損
**対処法**:
1. バックアップファイル使用
2. 自動回復機能確認
3. 入力済み内容の復元
4. 再入力の最小化

---

## 📞 緊急連絡先・エスカレーション

### 緊急時連絡フロー
1. **レベル1**: 自己解決（本資料・マニュアル参照）
2. **レベル2**: システム管理者連絡
3. **レベル3**: 開発チーム・外部サポート連絡

### 連絡すべき状況
- システム完全停止
- データ消失・破損
- セキュリティインシデント
- 月次レポート期限に間に合わない可能性

### 連絡時に伝える情報
- 発生日時
- 症状・エラーメッセージ
- 実施した対処法
- 緊急度（高・中・低）
- 影響範囲

---

## 🔒 セキュリティ・データ保護

### 重要ファイルの管理

#### 絶対に保護すべきファイル
- `service_account.json` - Google API認証情報
- `settings.json` - システム設定
- 完成版Excelレポート - 個人情報含有

#### バックアップ戦略
- **日次**: 出席データのエクスポート
- **週次**: システム設定ファイル
- **月次**: 完成レポート・全データ

#### アクセス制御
- システムPCの画面ロック必須
- USBメモリでの持ち出し禁止
- メールでの個人情報送信禁止

### データ漏洩時の対応
1. **即座の対応**
   - システム停止
   - 影響範囲特定
   - 上長へ報告

2. **事後対応**
   - インシデント記録作成
   - 再発防止策検討
   - セキュリティ設定見直し

---

## 📈 改善・メンテナンス

### 定期メンテナンス

#### 月次メンテナンス
- システムログの確認・削除
- 不要ファイルの削除
- パフォーマンス確認
- セキュリティ更新の確認

#### 年次メンテナンス
- Google APIキーの更新
- プリンタードライバー更新
- システム全体のバージョンアップ
- ハードウェア交換検討

### システム改善提案

#### 改善案の検討項目
- 操作性向上
- 処理速度改善
- 新機能追加
- セキュリティ強化

#### 提案時の記載事項
- 現状の課題
- 改善案の詳細
- 期待される効果
- 実装工数の概算

---

## 📚 参考資料

### マニュアル・ドキュメント
- **ユーザーマニュアル**: `manual/index.html`
- **技術仕様**: `README.md`
- **開発引継ぎ資料**: `引継ぎ資料_v3.2.md`

### 外部リソース
- [Google Sheets API ドキュメント](https://developers.google.com/sheets/api)
- [Brother P-touch Editor ユーザーガイド](https://support.brother.co.jp/)
- [Kivy フレームワーク ドキュメント](https://kivy.org/doc/stable/)

---

## ✅ 引継ぎ完了チェック

### 引継ぎを受ける方の確認事項
- [ ] システムの基本操作を理解した
- [ ] 日常業務フローを把握した
- [ ] 月次業務（特にコメント記入）を理解した
- [ ] 緊急時対応手順を確認した
- [ ] 連絡先・エスカレーション手順を把握した
- [ ] 重要ファイルの場所・管理方法を理解した
- [ ] セキュリティ要件を理解した
- [ ] 不明点・疑問点を解消した

### 引継ぎを行う方の確認事項
- [ ] 実際の操作を実演した
- [ ] 過去のトラブル事例を共有した
- [ ] 改善提案・要望事項を伝達した
- [ ] 緊急連絡先を共有した
- [ ] 必要な権限・アクセス許可を移譲した
- [ ] バックアップファイルの場所を共有した
- [ ] 引継ぎ記録を作成した

---

## 📝 引継ぎ記録

**引継ぎ実施日**: ___________  
**引継ぎ者**: ___________  
**被引継ぎ者**: ___________  

### 特記事項・申し送り事項
```
（記入欄）


```

### 改善要望・課題事項
```
（記入欄）


```

**引継ぎ者署名**: ___________  
**被引継ぎ者署名**: ___________  
**確認者署名**: ___________  

---

**※このドキュメントは機密情報を含むため、適切に管理してください**  
**※システム更新時は本資料も併せて更新してください**